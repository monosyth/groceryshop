import{Q as M,r as d,af as q,ag as N,q as W,z as V,j as e,B as l,w as t,U as C,V as D,W as Y,ai as $,T as a,X as x,E as g,y as k,F as v,D as u,x as z,O as K,I as T,K as Q,L as R,S as X,G as _,l as F,o as J,k as Z,p as ee,n as se}from"./index-Ckji0Gfo.js";import{C as I,a as ie}from"./CardContent-BYqZo48R.js";import{G as A}from"./Grid-Dj9NohOV.js";import{C as b}from"./Chip-BrmoHfWe.js";import{A as te,F as ne,L as oe}from"./Link-DNYENxpo.js";import{C as re}from"./Checkbox-CjJaPUpD.js";import{D as ae}from"./Delete-D_jyPChg.js";import{D as le,a as ce,b as de,c as xe}from"./DialogTitle-Di6momwO.js";import{C as me}from"./Close-CgMIaRd2.js";import{D as L}from"./Divider-Ds6ZPDmg.js";import"./useFormControl-BqbibeSw.js";function ze(){const{currentUser:j}=M(),[m,B]=d.useState([]),[P,O]=d.useState(!0),[n,y]=d.useState(null),[S,w]=d.useState({}),[f,p]=d.useState({open:!1,message:"",severity:"info"});d.useEffect(()=>{if(!j)return;const s=q(W(F,"savedRecipes"),N("userId","==",j.uid)),i=V(s,r=>{const o=[];r.forEach(c=>{o.push({id:c.id,...c.data()})}),o.sort((c,h)=>{const G=c.savedAt?.toDate()||new Date(0);return(h.savedAt?.toDate()||new Date(0))-G}),B(o),O(!1)},r=>{console.error("Error fetching recipes:",r),O(!1)});return()=>i()},[j]);const E=async s=>{try{await J(Z(F,"savedRecipes",s))}catch(i){console.error("Error deleting recipe:",i)}},H=(s,i)=>{w(r=>{const o=r[s]||[];return o.includes(i)?{...r,[s]:o.filter(c=>c!==i)}:{...r,[s]:[...o,i]}})},U=async(s,i)=>{const r=S[s]||[];if(r.length===0){p({open:!0,message:"Please select ingredients to add",severity:"warning"});return}try{const o=W(F,"shoppingList"),c=r.map(h=>ee(o,{userId:j.uid,name:h,checked:!1,fromRecipe:i,createdAt:se()}));await Promise.all(c),w(h=>({...h,[s]:[]})),p({open:!0,message:`Added ${r.length} item${r.length>1?"s":""} to shopping list!`,severity:"success"})}catch(o){console.error("Error adding to shopping list:",o),p({open:!0,message:"Failed to add items to shopping list",severity:"error"})}};return P?e.jsx(l,{sx:{background:`linear-gradient(180deg, ${t.bg} 0%, ${C} 100%)`,minHeight:"100vh",pb:4},children:e.jsx(D,{maxWidth:"lg",children:e.jsx(l,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh"},children:e.jsx(Y,{size:60,sx:{color:t.main}})})})}):e.jsx(l,{sx:{background:`linear-gradient(180deg, ${t.bg} 0%, ${C} 100%)`,minHeight:"100vh",pb:4},children:e.jsxs(D,{maxWidth:"lg",children:[e.jsxs(l,{sx:{pt:4,pb:3},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1.5,mb:1},children:[e.jsx($,{sx:{fontSize:"34px",color:t.main}}),e.jsx(a,{variant:"h3",sx:{fontFamily:"Outfit, sans-serif",fontWeight:700,color:t.main,fontSize:{xs:"28px",md:"34px"}},children:"My Recipes"})]}),e.jsx(a,{variant:"body1",sx:{fontFamily:"Outfit, sans-serif",fontWeight:400,color:x.main},children:m.length>0?`${m.length} saved recipe${m.length!==1?"s":""}`:"No saved recipes yet"})]}),m.length===0?e.jsxs(I,{sx:{bgcolor:g.bg,borderRadius:"16px",border:`2px solid ${g.main}`,boxShadow:`3px 3px 0px ${g.light}`,p:5,textAlign:"center"},children:[e.jsx($,{sx:{fontSize:"56px",color:x.main,mb:2}}),e.jsx(a,{variant:"h5",sx:{fontFamily:"Outfit, sans-serif",fontWeight:600,color:x.main,mb:1,fontSize:"20px"},children:"No Saved Recipes Yet"}),e.jsx(a,{variant:"body1",sx:{fontFamily:"Outfit, sans-serif",fontWeight:400,color:x.dark},children:"Import recipes from URLs on the Recipes page to save them here!"})]}):e.jsx(A,{container:!0,spacing:2.5,children:m.map(s=>e.jsx(A,{item:!0,xs:12,sm:6,md:4,children:e.jsx(I,{sx:{bgcolor:C,borderRadius:"12px",border:`2px solid ${k.border}`,boxShadow:`3px 3px 0px ${k.border}`,height:"100%",display:"flex",flexDirection:"column",cursor:"pointer"},onClick:()=>y(s),children:e.jsxs(ie,{sx:{p:2.5,flex:1,display:"flex",flexDirection:"column"},children:[e.jsx(a,{variant:"h6",sx:{fontFamily:"Outfit, sans-serif",fontWeight:700,color:t.main,fontSize:"16px",mb:1,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:s.name}),e.jsx(a,{variant:"body2",sx:{fontFamily:"Outfit, sans-serif",color:v.main,fontSize:"13px",mb:2,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",flex:1},children:s.description}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap",mb:2},children:[s.prepTime&&s.cookTime&&e.jsx(b,{icon:e.jsx(te,{sx:{fontSize:14}}),label:`${s.prepTime}-${s.cookTime} min`,size:"small",sx:{bgcolor:t.bg,color:t.dark,fontFamily:"Outfit, sans-serif",fontSize:"11px"}}),s.ingredients&&e.jsx(b,{label:`${s.ingredients.length} ingredients`,size:"small",sx:{bgcolor:g.bg,color:x.dark,fontFamily:"Outfit, sans-serif",fontSize:"11px"}})]}),s.ingredients&&s.ingredients.length>0&&e.jsxs(l,{sx:{bgcolor:v.bg,borderRadius:"8px",p:1.5,mb:2,border:`1px solid ${k.border}`},children:[e.jsx(a,{variant:"caption",sx:{fontFamily:"Outfit, sans-serif",fontWeight:600,color:u.main,fontSize:"12px",display:"block",mb:1},children:"Ingredients:"}),e.jsx(l,{sx:{maxHeight:"150px",overflowY:"auto"},children:s.ingredients.map((i,r)=>e.jsx(ne,{control:e.jsx(re,{size:"small",checked:(S[s.id]||[]).includes(i),onChange:()=>H(s.id,i),onClick:o=>o.stopPropagation(),sx:{color:t.main,"&.Mui-checked":{color:t.main},py:.25}}),label:e.jsx(a,{variant:"caption",sx:{fontFamily:"Outfit, sans-serif",color:u.main,fontSize:"12px"},children:i}),sx:{display:"flex",my:0,width:"100%"},onClick:o=>o.stopPropagation()},r))}),e.jsx(z,{size:"small",variant:"contained",fullWidth:!0,startIcon:e.jsx(K,{}),onClick:i=>{i.stopPropagation(),U(s.id,s.name)},disabled:(S[s.id]||[]).length===0,sx:{mt:1.5,bgcolor:t.main,color:"white",fontFamily:"Outfit, sans-serif",fontWeight:600,fontSize:"11px",textTransform:"none",py:.75,"&:hover":{bgcolor:t.dark},"&:disabled":{bgcolor:t.light,color:"white"}},children:"Add to Shopping List"})]}),e.jsxs(l,{sx:{pt:2,borderTop:`1px solid ${k.border}`,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(a,{variant:"caption",sx:{fontFamily:"Outfit, sans-serif",color:u.light,fontSize:"11px"},children:"Click to view details"}),e.jsx(T,{size:"small",onClick:i=>{i.stopPropagation(),E(s.id)},sx:{color:Q.dark},children:e.jsx(ae,{sx:{fontSize:18}})})]})]})})},s.id))}),e.jsx(le,{open:!!n,onClose:()=>y(null),maxWidth:"md",fullWidth:!0,children:n&&e.jsxs(e.Fragment,{children:[e.jsxs(ce,{sx:{fontFamily:"Outfit, sans-serif",fontWeight:700,color:t.main,pr:6},children:[n.name,e.jsx(T,{onClick:()=>y(null),sx:{position:"absolute",right:8,top:8},children:e.jsx(me,{})})]}),e.jsxs(de,{children:[e.jsx(a,{variant:"body2",sx:{fontFamily:"Outfit, sans-serif",color:v.main,mb:2},children:n.description}),e.jsxs(l,{sx:{display:"flex",gap:1,mb:3,flexWrap:"wrap"},children:[n.prepTime&&e.jsx(b,{label:`Prep: ${n.prepTime} min`,size:"small",sx:{bgcolor:t.bg,color:t.dark,fontFamily:"Outfit, sans-serif"}}),n.cookTime&&e.jsx(b,{label:`Cook: ${n.cookTime} min`,size:"small",sx:{bgcolor:g.bg,color:x.dark,fontFamily:"Outfit, sans-serif"}}),n.servings&&e.jsx(b,{label:`Servings: ${n.servings}`,size:"small",sx:{bgcolor:R.bg,color:R.dark,fontFamily:"Outfit, sans-serif"}})]}),e.jsx(L,{sx:{my:2}}),e.jsx(a,{variant:"h6",sx:{fontFamily:"Outfit, sans-serif",fontWeight:600,color:t.main,fontSize:"16px",mb:1.5},children:"Ingredients"}),e.jsx(l,{component:"ul",sx:{pl:2.5},children:n.ingredients.map((s,i)=>e.jsx(a,{component:"li",variant:"body2",sx:{fontFamily:"Outfit, sans-serif",color:u.main,fontSize:"14px",mb:.5},children:s},i))}),n.instructions&&n.instructions.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(L,{sx:{my:2}}),e.jsx(a,{variant:"h6",sx:{fontFamily:"Outfit, sans-serif",fontWeight:600,color:t.main,fontSize:"16px",mb:1.5},children:"Instructions"}),e.jsx(l,{component:"ol",sx:{pl:2.5},children:n.instructions.map((s,i)=>e.jsx(a,{component:"li",variant:"body2",sx:{fontFamily:"Outfit, sans-serif",color:u.main,fontSize:"14px",mb:1},children:s},i))})]})]}),e.jsxs(xe,{sx:{p:2},children:[n.sourceUrl&&e.jsx(z,{startIcon:e.jsx(oe,{}),href:n.sourceUrl,target:"_blank",sx:{fontFamily:"Outfit, sans-serif",fontWeight:600,textTransform:"none",color:t.main},children:"View Original"}),e.jsx(z,{onClick:()=>y(null),sx:{fontFamily:"Outfit, sans-serif",fontWeight:600,textTransform:"none",color:v.main},children:"Close"})]})]})}),e.jsx(X,{open:f.open,autoHideDuration:4e3,onClose:()=>p({...f,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(_,{onClose:()=>p({...f,open:!1}),severity:f.severity,sx:{width:"100%"},children:f.message})})]})})}export{ze as default};
